<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Rule Details</title>
	<meta name="author" content="HappyGnome">
	<link rel="stylesheet" href="style.css">
	<script src="jquery-3.3.1.min.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
	<script type="application/javascript" src="GenerateRuleBox.js"></script>
	<script type="application/javascript">
		function ToggleNotes(ruleID){
			$("#rule"+ruleID+" .rulefooter").toggle();
		};
		$(document).ready(function(){	
			var ruleIDstr=/[0-9]+/.exec(location.search);	
			if(ruleIDstr){
				var ruleID=parseInt(ruleIDstr);
				$.ajax({url:"rules.json", type:"GET", dataType:"json"})
				.done(function(rules){
					if (ruleID<0 || ruleID>=rules.rules.length){
						$("#title").text("Rule Not Found!");
						return;
					}
					var rule=rules.rules[ruleID];
					$("#title").text("Rule "+rule.label+ " Details");
					
					//load propositions while we render the rule##############################
					$.ajax({url:"propositions.json", type:"GET", dataType:"json"})
					.done(function(props){
						for (var i=0; i<props.propositions.length; i++){		
							var prop=props.propositions[i];			
							if(prop.ineffect=="1") $("#prop_list").append(GenerateRuleBox(props.propositions, i,true,false,"index.html",false));
							else $("#prop_list_repealed").append(GenerateRuleBox(props.propositions,i,true,false,"index.html",false))
						}
					})
					.fail(function(){
						alert("Oops! Retrieval of rules data failed.");
						<!--TODO-->
					});
					
					//Back to the rule!#################################################
					if(rule.ineffect=="1") $("#rules_list").append(GenerateRuleBox(rules.rules,ruleID,true,true,"index.html",false));
					else $("#rules_list_repealed").append(GenerateRuleBox(rules.rules,ruleID,true,true,"index.html",false))
				})
				.fail(function(){
					alert("Oops! Retrieval of rules data failed.");
					<!--TODO-->
				});	
			}
		});
	</script>
	
	<div class="page_head">
		<h1 id="title">Rule Details</h1><h2 id="title_annot"></h2>
	</div>
	<div class="rules_list" id="rules_list">
	</div>
	<div class="rules_list rules_list_repealed" id="rules_list_repealed">
	</div>
	<h2 class="repealed_heading">Related Propositions (enacted):</h2>
	<div class="rules_list" id="prop_list">
	</div>
	<h2 class="repealed_heading">Related Propositions (not enacted):</h2>
	<div class="rules_list rules_list_repealed" id="prop_list_repealed">
	</div>
</body>
</html>